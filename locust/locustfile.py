#!/usr/bin/python

import time
from locust import task
from locust.contrib.fasthttp import FastHttpUser
from time import gmtime, strftime
import random

import requests
requests.packages.urllib3.disable_warnings()

import resource

resource.setrlimit(resource.RLIMIT_NOFILE, (999999, 999999))

class FastUser(FastHttpUser):

    @task
    def validateTreasuryValid(self):
        time = strftime("%Y-%m-%dT%H:%M:%SZ", gmtime())
        with self.client.post("/vss/v2/validate", data=None, json={"validationPolicyId": "2.16.840.1.101.10.2.18.2.1.4","x509Certificate":"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","clientMetadata":{"client":"Locust Test %s" % time}}, verify=False, timeout=(30, 30),
        catch_response=True) as response:
            if response.status_code == 0:
                print("Empty Response")
                response.failure(response)
            else:
                response.success()

    @task
    def validateTreasuryRevoked(self):
        time = strftime("%Y-%m-%dT%H:%M:%SZ", gmtime())
        with self.client.post("/vss/v2/validate", data=None, json={"validationPolicyId": "2.16.840.1.101.10.2.18.2.1.4","x509Certificate":"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","clientMetadata":{"client":"Locust Test %s" % time}}, verify=False, timeout=(30, 30),
        catch_response=True) as response:
            if response.status_code == 0:
                print("Empty Response")
                response.failure(response)
            else:
                response.success()
